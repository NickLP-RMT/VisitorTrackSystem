<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏°‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ - RMT Visitor Check-in</title>
  <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background:linear-gradient(135deg,#091f82 0%,#ffffff 100%);
      min-height:100vh;padding:20px;color:#333;line-height:1.6;
    }
    .header{
      background:rgba(255,255,255,.95);backdrop-filter:blur(10px);
      width:100%;max-width:650px;margin:0 auto 20px;padding:20px;
      border-radius:20px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.1)
    }
    .company-name{font-size:24px;font-weight:700;color:#2c5282;margin-bottom:5px;letter-spacing:.5px}
    .system-title{font-size:14px;color:#4a5568;font-weight:500;text-transform:uppercase;letter-spacing:1px}
    .container{
      width:100%;max-width:650px;margin:0 auto;background:rgba(255,255,255,.98);
      backdrop-filter:blur(10px);padding:30px;border-radius:20px;
      box-shadow:0 20px 40px rgba(0,0,0,.15);position:relative;overflow:hidden
    }
    .container::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#2c5282,#3182ce,#4299e1)}
    .main-title{text-align:center;color:#2c5282;margin-bottom:30px;font-size:24px;font-weight:600}
    .form-section{background:#f8fafc;padding:25px;border-radius:15px;margin-bottom:25px;border:1px solid #e2e8f0}
    .section-title{font-size:16px;font-weight:600;color:#2d3748;margin-bottom:20px}
    .form-group{margin-bottom:20px}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px}
    label{display:block;margin-bottom:8px;font-weight:600;font-size:14px;color:#2d3748}
    .required{color:#e53e3e}
    input,select{
      width:100%;padding:12px 16px;border-radius:10px;border:2px solid #e2e8f0;
      font-size:15px;transition:all .3s ease;background:#fff
    }
    input:focus,select:focus{outline:none;border-color:#3182ce;box-shadow:0 0 0 3px rgba(49,130,206,.1)}
    .row-inline{display:flex;align-items:center;gap:10px}
    .muted{font-size:13px;color:#4a5568}
    .total-pill{padding:8px 12px;border-radius:999px;background:#e6fffa;border:1px solid #81e6d9;color:#285e61;font-weight:700}
    .submit-button{
      width:100%;padding:16px 24px;font-size:16px;font-weight:600;
      background:linear-gradient(135deg,#2c5282 0%,#3182ce 100%);
      color:#fff;border:none;border-radius:12px;cursor:pointer;transition:.3s;
      box-shadow:0 4px 15px rgba(44,82,130,.3);margin-top:10px;
    }
    .submit-button:hover{background:linear-gradient(135deg,#2a4c80 0%,#2c7cb8 100%);transform:translateY(-2px)}
    .submit-button:disabled{background:#a0aec0;cursor:not-allowed;transform:none;box-shadow:none}
    .btn-secondary{
      width:100%;padding:12px 20px;font-size:15px;font-weight:600;background:#edf2f7;color:#2d3748;
      border:none;border-radius:10px;cursor:pointer;transition:.2s; margin-top:10px
    }
    .btn-secondary:hover{background:#e2e8f0}
    .back-button{
      position:fixed;top:20px;left:20px;background:rgba(255,255,255,.9);backdrop-filter:blur(10px);
      border:none;padding:12px 16px;border-radius:50px;cursor:pointer;font-size:14px;font-weight:500;
      color:#2c5282;transition:all .3s ease;box-shadow:0 4px 15px rgba(0,0,0,.1);z-index:1000
    }
    .back-button:hover{background:#fff;transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.15)}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading{display:inline-block;width:20px;height:20px;border:2px solid #fff;border-radius:50%;border-top-color:transparent;animation:spin 1s linear infinite}
  </style>
</head>
<body>
  <button class="back-button" onclick="history.back()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>

  <div class="header">
    <div class="company-name">Resonac Materials (Thailand) Co., Ltd.</div>
    <div class="system-title">Visitor Registration System</div>
  </div>

  <div class="container">
    <h2 class="main-title">üìã ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏°‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h2>

    <form id="visitorForm" autocomplete="off">
      <div class="form-section">
        <div class="section-title">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>

        <div class="form-group">
          <label for="fullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
          <input type="text" id="fullName" required minlength="2" maxlength="120" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô">
        </div>

        <div class="form-group">
          <label for="company">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î <span class="required">*</span></label>
          <input type="text" id="company" required minlength="2" maxlength="120" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="carPlate">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ <span class="required">*</span></label>
            <input type="text" id="carPlate" maxlength="12" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏Å 1234 / ABC 1234" required>
          </div>

          <div class="form-group">
            <label for="followers">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</label>
            <select id="followers">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
            <div class="row-inline muted" style="margin-top:8px">
              <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
              <span id="totalPeople" class="total-pill">1 ‡∏Ñ‡∏ô</span>
            </div>
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="section-title">üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</div>

        <div class="form-row">
          <div class="form-group">
            <label for="purpose">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå <span class="required">*</span></label>
            <select id="purpose" required>
              <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
              <option value="‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏á‡∏≤‡∏ô">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏á‡∏≤‡∏ô</option>
              <option value="‡∏™‡πà‡∏á-‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">‡∏™‡πà‡∏á/‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
              <option value="‡∏™‡πà‡∏á/‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">‡∏™‡πà‡∏á/‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
              <option value="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</option>
              <option value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
            </select>
          </div>

          <div class="form-group" id="purposeOtherGroup" style="display:none">
            <label for="purposeOther">‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô ‡πÜ)</label>
            <input type="text" id="purposeOther" maxlength="120" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">
          </div>

          <div class="form-group">
            <label for="department">‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ <span class="required">*</span></label>
            <select id="department" required>
              <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
              <option value="PD">PD</option>
              <option value="PC-W/H">PC-W/H</option>
              <option value="PE">PE</option>
              <option value="QA/QC">QA/QC</option>
              <option value="Design">Design</option>
              <option value="‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
              <option value="‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠">‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</option>
              <option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
              <option value="‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
              <option value="Safety">Safety</option>
              <option value="‡πÑ‡∏≠‡∏ó‡∏µ">‡πÑ‡∏≠‡∏ó‡∏µ</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="contactPerson">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö <span class="required">*</span></label>
          <input type="text" id="contactPerson" required minlength="2" maxlength="120" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö">
        </div>

        <button type="submit" class="submit-button" id="submitBtn">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</button>
        <button type="button" class="btn-secondary" id="resetBtn">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
      </div>
    </form>
  </div>

  <script>
    const $=s=>document.querySelector(s);
    const $$=s=>document.querySelectorAll(s);
    const formatCarPlate=v=>v.toUpperCase().replace(/\s+/g,' ').trim();
    const calcTotal=()=>$('#totalPeople').textContent=(1+parseInt($('#followers').value||0,10))+' ‡∏Ñ‡∏ô';
    const getFormData=()=>({
      fullName:$('#fullName').value.trim(),
      company:$('#company').value.trim(),
      carPlate:$('#carPlate').value.trim(),
      followers:$('#followers').value,
      purpose:$('#purpose').value==='‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'?($('#purposeOther').value.trim()||'‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'):$('#purpose').value,
      contactPerson:$('#contactPerson').value.trim(),
      department:$('#department').value,
      total:1+parseInt($('#followers').value||0,10),
      ts:new Date().toISOString()
    });
    const setLoading=s=>{const b=$('#submitBtn');b.innerHTML=s?'<span class="loading"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code...':'‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code';b.disabled=s;};

    document.addEventListener('DOMContentLoaded',()=>{
      $('#followers').addEventListener('change',calcTotal);calcTotal();
      $('#purpose').addEventListener('change',()=>{$('#purposeOtherGroup').style.display=$('#purpose').value==='‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'?'':'none';});
      $('#carPlate').addEventListener('input',e=>{const p=e.target.selectionStart;e.target.value=formatCarPlate(e.target.value);e.target.setSelectionRange(p,p);});
    });

    $('#resetBtn').addEventListener('click',()=>{$('#visitorForm').reset();$('#purposeOtherGroup').style.display='none';$('#totalPeople').textContent='1 ‡∏Ñ‡∏ô';});

    let submitting=false;
    $('#visitorForm').addEventListener('submit',e=>{
      e.preventDefault();if(submitting)return;
      const data=getFormData();
      if(!data.fullName||!data.company||!data.contactPerson||!data.department||!data.purpose)
        return Swal.fire({icon:'warning',title:'‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',text:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô'});
      if($('#purpose').value==='‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'&&!$('#purposeOther').value.trim())
        return Swal.fire({icon:'warning',title:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå',text:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‚Äú‡∏≠‡∏∑‡πà‡∏ô ‡πÜ‚Äù'});

      submitting=true;setLoading(true);
      setTimeout(()=>{
        try{
          const compressed=LZString.compressToEncodedURIComponent(JSON.stringify(data));
          const wrap=document.createElement('div');
          wrap.innerHTML=`
            <div id="qr-code-container" style="display:flex;justify-content:center"></div>
            <div style="font-size:13px;margin-top:12px;color:#2d3748;background:#fefcbf;border:1px solid #f6e05e;border-radius:8px;padding:10px">
              üì∏ ‡πÇ‡∏õ‡∏£‡∏î‡∏¢‡∏∑‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
            </div>`;
          new QRCode(wrap.querySelector('#qr-code-container'),{text:compressed,width:280,height:280,colorDark:"#000",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.H});
          Swal.fire({title:'QR Code ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',html:wrap,width:360,confirmButtonText:'‡∏õ‡∏¥‡∏î'});
        }catch(err){
          console.error(err);
          Swal.fire({icon:'error',title:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',text:'‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÑ‡∏î‡πâ'});
        }finally{submitting=false;setLoading(false);}
      },500);
    });
  </script>
</body>
</html>
